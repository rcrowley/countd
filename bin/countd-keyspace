#!/usr/bin/env python

from countd import settings
from countd import permanent
import optfunc
import sys

@optfunc.main
def main(keyspace):
    """Usage: %prog <keyspace>"""

    sys.stderr.write("[countd-keyspace] %s/%s/keyspace\n" % (
        settings.DIRNAME,
        keyspace
    ))
    keyspace = permanent.Keyspace(keyspace, permanent.Keyspace.READ)
    offset, length = 0, 0
    while 1:
        r = keyspace.range(offset, 200)
        for key, count in r:
            print("%-69s %10d" % (key, count))
            length += 1
        if 200 != length:
            break
        offset += length
        length = 0
