#!/usr/bin/env python

from countd import settings
from countd.commitlog.file import File
import optfunc
import sys

@optfunc.main
def main(index):
    """Usage: %prog <index>"""

    sys.stderr.write("[countd-commitlog] %s/%010u\n" % (
        settings.DIRNAME,
        int(index)
    ))
    file = File(int(index), File.READ)
    for m in file:
        if 0 == m.increment:
            continue
        print("%-34s %-34s %10d" % (m.keyspace, m.key, m.increment))
